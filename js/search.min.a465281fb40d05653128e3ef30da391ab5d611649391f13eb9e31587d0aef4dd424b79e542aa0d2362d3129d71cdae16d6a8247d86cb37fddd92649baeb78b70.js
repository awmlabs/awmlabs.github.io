const summaryInclude=60,fuseOptions={shouldSort:!0,includeMatches:!0,threshold:0,tokenize:!0,location:0,distance:100,maxPatternLength:32,minMatchCharLength:1,keys:[{name:"title",weight:.8},{name:"contents",weight:.5},{name:"tags",weight:.3},{name:"categories",weight:.3}]},searchQuery=param("s");searchQuery?($("#search-query").val(searchQuery),executeSearch(searchQuery)):$("#search-results").append("<p>Please enter a word or phrase above</p>");function executeSearch(e){$.getJSON("/index.json",t=>{const s=t,o=new Fuse(s,fuseOptions),n=o.search(e);n.length>0?populateResults(n):$("#search-results").append("<p>No matches found</p>")})}function populateResults(e){$.each(e,(e,t)=>{const{content:n}=t.item;let s="";const o=[];fuseOptions.tokenize?o.push(searchQuery):$.each(t.matches,(e,t)=>{if(t.key==="tags"||t.key==="categories")o.push(t.value);else if(t.key==="content"){const e=t.indices[0][0]-summaryInclude>0?t.indices[0][0]-summaryInclude:0,i=t.indices[0][1]+summaryInclude<n.length?t.indices[0][1]+summaryInclude:n.length;s+=n.substring(e,i),o.push(t.value.substring(t.indices[0][0],t.indices[0][1]-t.indices[0][0]+1))}}),s.length<1&&(s+=n.substring(0,summaryInclude*2));const i=$("#search-result-template").html(),a=render(i,{key:e,title:t.item.title,link:t.item.permalink,tags:t.item.tags,author:t.item.author,date:t.item.dates,categories:t.item.categories,snippet:s});$("#search-results").append(a),$.each(o,(t,n)=>{$(`#summary-${e}`).mark(n)})})}function param(e){return decodeURIComponent((location.search.split(`${e}=`)[1]||"").split("&")[0]).replace(/\+/g," ")}function render(e,t){let s;const o=/\$\{\s*isset ([a-zA-Z]*) \s*\}(.*)\$\{\s*end\s*}/g;let n=e;for(;(s=o.exec(e))!==null;)t[s[1]]?n=n.replace(s[0],s[2]):n=n.replace(s[0],"");for(const e in t)n=n.replace(new RegExp(`\\$\\{\\s*${e}\\s*\\}`,"g"),t[e]),e==="date"&&(n=n.replace(new RegExp("\\$\\{\\s*dateFmt\\s*\\}","g"),new Date(t[e]).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),t[e]));return n}